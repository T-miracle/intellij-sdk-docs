<!-- Copyright 2000-2023 JetBrains s.r.o. and contributors. Use of this source code is governed by the Apache 2.0 license. -->

# IntelliJ 平台编码指南

<link-summary>为 IntelliJ 平台贡献的代码的编码指南。</link-summary>

如果您正在编写想要贡献给 IntelliJ 平台的代码，遵循这些指南将使 JetBrains 开发团队更容易审查并接受您的更改。

## 遵循最新的源代码

如果您提交补丁，我们强烈建议您根据 [intellij-community Git 存储库](intellij_platform.md#open-source) 中的最新版本代码构建补丁。
最简单的方法是克隆存储库，在 Git 中跟踪您的工作，并按照 [](platform_contributions.md#submit-a-patch) 中所述提供更改。

## 一般架构原则

请尽量遵循常见的 Java 架构原则，Joshua Bloch 的《Effective Java》是一个好的开始。

## 测试

功能测试涵盖了 IntelliJ IDEA 的大部分现有功能。
如果测试覆盖了您正在修改的区域，则必须运行测试并确保您的更改不会引入任何新的问题。
强烈建议您提供新的功能测试，以涵盖您修复的错误或添加的新功能。

## 代码格式化

我们通常对代码格式相当宽松，但至少必须遵守以下约定：

- 源文件中的 2 个空格缩进
- 对实例变量使用 “my” 前缀，对类变量使用 “our” 前缀。
- 新的源代码文件必须包含带有 Apache 2 许可证的版权声明和贡献者姓名。

遵循我们的代码格式化指南的最简单方法是使用共享代码样式重新格式化您的代码提交，该样式包含在 IntelliJ IDEA 社区版 项目目录中。

## 检查

IntelliJ IDEA 社区版 项目包括共享检查配置文件。
我们强烈建议您确保提交的代码中，不包含该检查配置文件配置的检查突出显示的任何警告。

## Javadoc 注释

如果您的代码添加了新的 OpenAPI 接口、类、方法或扩展点，则必须提供描述 API 参数和预期用途的 Javadoc 注释。
为代码的其他部分提供 Javadoc 或其他注释是一个好主意，但不是必需的。

## 提交

为了避免在检查更改时进行不必要的工作，请遵循以下准则：

- 在将补丁或拉取请求提交给我们之前，请仔细检查您在补丁或拉取请求中的所有更改。
  确保你所做的一切改变都是有原因的。
- 请不要在补丁中包含未完成的工作。
  确保它不包含任何 TODO 注释。
  如果您添加了一些代码但最终不需要它，请确保在提交补丁之前将其删除。
- 请不要包含任何影响格式、修复“黄色代码”（警告）、代码样式的更改 以及 修复错误或实现功能 的实际更改。
  没有人喜欢留下糟糕的代码，但请记住，混合这些更改会使审查过程变得复杂。
- 请不要在单个补丁或拉取请求中修复多个问题。
- 请不要将更改提交到配置文件（<path>runConfigurations/IDEA.xml</path>、<path>codeStyleSettings.xml</path>、<path>misc.xml</path> 等），除非这对于修复本身至关重要。
- 除非修复所必需，否则请避免移动或重命名代码。保持向后兼容性对于平台至关重要。

理想的拉取请求将包含一次提交，其中包含修复错误或实现功能所需的所有内容，但仅此而已。
“尽早提交，经常提交”完全适用于本地提交，但是这样的“公开提交”很难审查(审阅者需要花费更多的时间来审查正在进行的工作，或者一次审查所有更改，从而丢失存储在提交消息中的有价值的信息)。

最好的办法是尽早提交，然后将所有提交压缩为一个带有描述性提交消息的提交。

有时，对单个问题进行多次提交也是可以接受的，但每个提交都应该是解决问题的独立“步骤”。
